<!doctype html><style>html{height:100vh}body{min-height:100vh;display:grid;grid-template-rows:1fr auto}.footer{grid-row-start:2;grid-row-end:3}</style><html lang=en-gb><head><meta charset=utf-8><title>Sam Robbins</title><link rel=canonical href=https://samrobbins.uk/portfolio/bioinformatics/><meta name=viewport content="width=device-width,initial-scale=1"><meta name=monetization content="$ilp.uphold.com/reGxiLfZfUmn"><meta name=description property="og:description" content="Writing a range of algorithms for Bioinformatics"><meta name=image property="og:image" content="/"><meta name=author content="Sam Robbins"><meta name=generator content="Hugo 0.75.1"><link rel=stylesheet href=/css/syntax.min.css integrity media=screen><script src=https://cdn.jsdelivr.net/npm/mailgo@0.9.14/dist/mailgo.min.js defer></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link href=/css/tailwind.min.css rel=stylesheet><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js integrity=sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js integrity=sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "8348650db5154c01999667d263b7e6e1"}'></script></head><body class=portfolio><div class=wrapper><nav class="fixed h-16 p-4 bg-white border-b border-gray-200 w-full z-20"><div class="flex divide-x-4 divide-transparent pr-6 text-lg items-center text-gray-700"><a href=/ class=font-normal>Home</a>
<a href=/about/ title=About>About</a>
<a href=/blog/ title=Blog>Blog</a>
<a class="text-gray-800 font-semibold" href=/portfolio/ title=Portfolio>Portfolio</a>
<a href=/writing/ title=Writing>Writing</a></div></nav><section class="pt-20 px-4"><div class="container mx-auto"><h1 class="text-4xl text-center font-semibold">Bioinformatics</h1><p class="text-center text-gray-600 text-xl">Writing a range of algorithms for Bioinformatics</p><div class="py-4 text-gray-600"><p class=text-center><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="h-4 w-4 inline-block stroke-current text-gray-600"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5A2 2 0 003 7v12a2 2 0 002 2z"/></svg>May 02, 2019</p><p class=text-center><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="h-4 w-4 inline-block stroke-current text-gray-600"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3A9 9 0 113 12a9 9 0 0118 0z"/></svg>2 minutes</p></div><div class="flex justify-center gap-x-40 gap-y-4 flex-wrap"><div class="border border-gray-500 px-4 py-2 w-32"><a href=https://github.com/samrobbins85/CT-Bioinformatics-Coursework><img src=https://unpkg.com/simple-icons@v3/icons/github.svg class="inline-block h-6 w-6 mr-2"> Github</a></div></div><hr class=my-4><h2 class="text-center text-3xl">Built with</h2><section class="py-6 px-2"><div class=container><div class="flex justify-center gap-x-10 flex-wrap gap-y-4"><div><a href=https://numpy.org/><img class="h-20 w-32 object-contain" src=https://res.cloudinary.com/samrobbins/image/upload/q_auto/v1593531782/numpy_qiayvh.svg alt=NumPy loading=lazy style=cursor:pointer></a></div><div><a href=https://networkx.github.io/><img class="h-20 w-32 object-contain" src=https://res.cloudinary.com/samrobbins/image/upload/q_auto/v1593526379/networkx_logo_zuw9qa.svg alt=NetworkX loading=lazy style=cursor:pointer></a></div><div><a href=https://www.python.org/><img class="h-20 w-32 object-contain" src=https://res.cloudinary.com/samrobbins/image/upload/q_auto/v1591793276/logos/logos_python_pjlesq.svg alt=Python loading=lazy style=cursor:pointer></a></div></div></div></section><hr class=py-4></div></div></section><div class="container prose mx-auto w-screen px-4 pb-6"><h2 id=dna-alignment>DNA Alignment</h2><p>This takes two DNA sequences and produces the optimal alignment. This is done by filling out a backtracking matrix.</p><p>This has a simple piece of driver code which loops through all the cells of the backtrack matrix</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>for</span> <span class=n>a</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>seq1</span><span class=p>)</span><span class=o>+</span><span class=mi>1</span><span class=p>):</span>
    <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>seq2</span><span class=p>)</span><span class=o>+</span><span class=mi>1</span><span class=p>):</span>
        <span class=n>fill_cell</span><span class=p>(</span><span class=n>m</span><span class=p>,</span><span class=n>backtrack</span><span class=p>,</span><span class=n>seq1</span><span class=p>,</span><span class=n>seq2</span><span class=p>,</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>)</span>
</code></pre></div><p>The <code>fill_cell</code> function then determines the entry in the backtracking matrix and the maximum score of a matching</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>fill_cell</span><span class=p>(</span><span class=n>m</span><span class=p>,</span><span class=n>backtrack</span><span class=p>,</span><span class=n>seq1</span><span class=p>,</span><span class=n>seq2</span><span class=p>,</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>):</span>
    <span class=c1># Here m is the matrix and [b,a] is the location of the cell to fill out</span>
    <span class=c1># Diagonal</span>
    <span class=nb>max</span><span class=o>=</span><span class=n>score</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>seq1</span><span class=p>,</span><span class=n>seq2</span><span class=p>)</span><span class=o>+</span><span class=n>m</span><span class=p>[</span><span class=n>b</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span><span class=n>a</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
    <span class=n>pos</span><span class=o>=</span><span class=s1>&#39;D&#39;</span>
    <span class=c1># Up</span>
    <span class=n>temp</span><span class=o>=</span><span class=n>m</span><span class=p>[</span><span class=n>b</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span><span class=n>a</span><span class=p>]</span><span class=o>-</span><span class=mi>2</span>
    <span class=k>if</span> <span class=n>temp</span><span class=o>&gt;</span><span class=nb>max</span><span class=p>:</span>
        <span class=nb>max</span><span class=o>=</span><span class=n>temp</span>
        <span class=n>pos</span><span class=o>=</span><span class=s1>&#39;U&#39;</span>
    <span class=c1># Left</span>
    <span class=n>temp</span><span class=o>=</span><span class=n>m</span><span class=p>[</span><span class=n>b</span><span class=p>,</span><span class=n>a</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>-</span><span class=mi>2</span>
    <span class=k>if</span> <span class=n>temp</span><span class=o>&gt;</span><span class=nb>max</span><span class=p>:</span>
        <span class=nb>max</span><span class=o>=</span><span class=n>temp</span>
        <span class=n>pos</span><span class=o>=</span><span class=s1>&#39;L&#39;</span>
    <span class=n>m</span><span class=p>[</span><span class=n>b</span><span class=p>,</span><span class=n>a</span><span class=p>]</span><span class=o>=</span><span class=nb>max</span>
    <span class=n>backtrack</span><span class=p>[</span><span class=n>b</span><span class=p>,</span><span class=n>a</span><span class=p>]</span><span class=o>=</span><span class=n>pos</span>
    <span class=k>return</span>
</code></pre></div><p>The rules for scoring were given in the assignment, and are implemented using the <code>score</code> function</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>score</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>seq1</span><span class=p>,</span><span class=n>seq2</span><span class=p>):</span>
    <span class=c1># This function finds the score of the matching</span>
    <span class=n>index_a</span><span class=o>=</span><span class=n>a</span><span class=o>-</span><span class=mi>1</span>
    <span class=n>index_b</span><span class=o>=</span><span class=n>b</span><span class=o>-</span><span class=mi>1</span>
    <span class=k>if</span> <span class=n>seq1</span><span class=p>[</span><span class=n>index_a</span><span class=p>]</span><span class=o>==</span><span class=n>seq2</span><span class=p>[</span><span class=n>index_b</span><span class=p>]:</span>
        <span class=k>if</span> <span class=n>seq1</span><span class=p>[</span><span class=n>index_a</span><span class=p>]</span><span class=o>==</span><span class=s1>&#39;A&#39;</span><span class=p>:</span>
            <span class=k>return</span> <span class=mi>4</span>
        <span class=k>if</span> <span class=n>seq1</span><span class=p>[</span><span class=n>index_a</span><span class=p>]</span><span class=o>==</span><span class=s1>&#39;C&#39;</span><span class=p>:</span>
            <span class=k>return</span> <span class=mi>3</span>
        <span class=k>if</span> <span class=n>seq1</span><span class=p>[</span><span class=n>index_a</span><span class=p>]</span><span class=o>==</span><span class=s1>&#39;G&#39;</span><span class=p>:</span>
            <span class=k>return</span> <span class=mi>2</span>
        <span class=k>if</span> <span class=n>seq1</span><span class=p>[</span><span class=n>index_a</span><span class=p>]</span><span class=o>==</span><span class=s1>&#39;T&#39;</span><span class=p>:</span>
            <span class=k>return</span> <span class=mi>1</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>print</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>seq1</span><span class=p>[</span><span class=n>index_a</span><span class=p>])</span><span class=o>+</span><span class=nb>str</span><span class=p>(</span><span class=n>seq2</span><span class=p>[</span><span class=n>index_b</span><span class=p>])</span><span class=o>+</span><span class=nb>str</span><span class=p>(</span><span class=n>index_a</span><span class=p>)</span><span class=o>+</span><span class=nb>str</span><span class=p>(</span><span class=n>index_b</span><span class=p>))</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=k>return</span> <span class=o>-</span><span class=mi>3</span>
</code></pre></div><p>The best alignment is then generated using the following function by moving through the backtracking matrix</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>gen_seq</span><span class=p>(</span><span class=n>backtrack</span><span class=p>,</span><span class=n>str1</span><span class=p>,</span><span class=n>str2</span><span class=p>):</span>
    <span class=n>coord</span><span class=o>=</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>str2</span><span class=p>),</span><span class=nb>len</span><span class=p>(</span><span class=n>str1</span><span class=p>))</span>
    <span class=n>matchstring1</span><span class=o>=</span><span class=s1>&#39;&#39;</span>
    <span class=n>matchstring2</span><span class=o>=</span><span class=s1>&#39;&#39;</span>
    <span class=k>while</span> <span class=n>coord</span><span class=o>!=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>):</span>
        <span class=k>if</span> <span class=n>backtrack</span><span class=p>[</span><span class=n>coord</span><span class=p>]</span><span class=o>==</span><span class=s1>&#39;D&#39;</span><span class=p>:</span>
            <span class=n>coord</span><span class=o>=</span><span class=p>(</span><span class=n>coord</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span><span class=n>coord</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
            <span class=n>matchstring1</span><span class=o>=</span><span class=n>matchstring1</span><span class=o>+</span><span class=n>str1</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
            <span class=n>str1</span><span class=o>=</span><span class=n>str1</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
            <span class=n>matchstring2</span> <span class=o>=</span> <span class=n>matchstring2</span> <span class=o>+</span> <span class=n>str2</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
            <span class=n>str2</span> <span class=o>=</span> <span class=n>str2</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
        <span class=k>if</span> <span class=n>backtrack</span><span class=p>[</span><span class=n>coord</span><span class=p>]</span><span class=o>==</span><span class=s1>&#39;U&#39;</span><span class=p>:</span>
            <span class=n>coord</span><span class=o>=</span><span class=p>(</span><span class=n>coord</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span><span class=n>coord</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
            <span class=n>matchstring1</span> <span class=o>=</span> <span class=n>matchstring1</span> <span class=o>+</span> <span class=s1>&#39;-&#39;</span>
            <span class=n>matchstring2</span> <span class=o>=</span> <span class=n>matchstring2</span> <span class=o>+</span> <span class=n>str2</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
            <span class=n>str2</span> <span class=o>=</span> <span class=n>str2</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
        <span class=k>if</span> <span class=n>backtrack</span><span class=p>[</span><span class=n>coord</span><span class=p>]</span><span class=o>==</span><span class=s1>&#39;L&#39;</span><span class=p>:</span>
                <span class=n>coord</span><span class=o>=</span><span class=p>(</span><span class=n>coord</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>coord</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
                <span class=n>matchstring1</span> <span class=o>=</span> <span class=n>matchstring1</span> <span class=o>+</span> <span class=n>str1</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
                <span class=n>str1</span> <span class=o>=</span> <span class=n>str1</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
                <span class=n>matchstring2</span> <span class=o>=</span> <span class=n>matchstring2</span> <span class=o>+</span> <span class=s1>&#39;-&#39;</span>
    <span class=n>matchstring1</span><span class=o>=</span><span class=n>matchstring1</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
    <span class=n>matchstring2</span> <span class=o>=</span> <span class=n>matchstring2</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
    <span class=k>return</span> <span class=p>[</span><span class=n>matchstring1</span><span class=p>,</span><span class=n>matchstring2</span><span class=p>]</span>
</code></pre></div><h3 id=drawing-a-phylogenetic-tree>Drawing a phylogenetic tree</h3><p>This task is to generate a phylogenetic tree based on an input distance matrix</p><p>For brevity I have removed the code which formats the input from the file so that it can be worked on along with the code to output the tree.</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>WPGMA</span><span class=p>(</span><span class=n>filename</span><span class=p>):</span>
	<span class=k>while</span> <span class=n>table</span><span class=o>.</span><span class=n>shape</span> <span class=o>!=</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>):</span>
		<span class=c1># Find the minimum value</span>
		<span class=n>minval</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>min</span><span class=p>(</span><span class=n>table</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>nonzero</span><span class=p>(</span><span class=n>table</span><span class=p>)])</span>
		<span class=c1># Find its coordinates</span>
		<span class=n>itemindex</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>table</span> <span class=o>==</span> <span class=n>minval</span><span class=p>)</span>
		<span class=c1># Merge the two species corresponding to those coordinates</span>
		<span class=n>table</span> <span class=o>=</span> <span class=n>mergespecies</span><span class=p>(</span><span class=n>table</span><span class=p>,</span> <span class=n>itemindex</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span> <span class=n>itemindex</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>],</span> <span class=n>names</span><span class=p>,</span> <span class=n>names2</span><span class=p>)</span>
		<span class=n>nametable</span><span class=o>=</span><span class=p>[</span><span class=nb>str</span><span class=p>(</span><span class=n>name</span><span class=p>)</span> <span class=k>for</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>names2</span><span class=p>]</span>
		<span class=n>stack1</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>nametable</span><span class=p>)</span>
		<span class=n>stacktotal</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>vstack</span><span class=p>((</span><span class=n>stack1</span><span class=p>,</span><span class=n>table</span><span class=p>))</span>
		<span class=k>print</span><span class=p>(</span><span class=n>stacktotal</span><span class=p>)</span>
</code></pre></div><p>And the function to merge species is as follows:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>mergespecies</span><span class=p>(</span><span class=n>table</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>names</span><span class=p>,</span> <span class=n>names2</span><span class=p>):</span>
	<span class=n>depth</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>L</span><span class=p>:</span> <span class=p>(</span><span class=nb>isinstance</span><span class=p>(</span><span class=n>L</span><span class=p>,</span> <span class=nb>list</span><span class=p>)</span> <span class=ow>and</span> <span class=p>(</span><span class=nb>max</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=n>depth</span><span class=p>,</span> <span class=n>L</span><span class=p>))</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=k>if</span> <span class=n>L</span> <span class=k>else</span> <span class=mi>1</span><span class=p>)</span> <span class=ow>or</span> <span class=mi>0</span>
	<span class=k>if</span> <span class=n>depth</span><span class=p>(</span><span class=n>names</span><span class=p>[</span><span class=n>a</span><span class=p>])</span><span class=o>&lt;</span><span class=n>depth</span><span class=p>(</span><span class=n>names</span><span class=p>[</span><span class=n>b</span><span class=p>]):</span>
		<span class=n>names</span><span class=p>[</span><span class=n>a</span><span class=p>],</span><span class=n>names</span><span class=p>[</span><span class=n>b</span><span class=p>]</span><span class=o>=</span><span class=n>names</span><span class=p>[</span><span class=n>b</span><span class=p>],</span><span class=n>names</span><span class=p>[</span><span class=n>a</span><span class=p>]</span>
	<span class=c1># print(&#34;Merge:&#34; + str(names[a]) + &#34; and &#34; + str(names[b]))</span>
	<span class=n>graphmerge</span><span class=p>(</span><span class=n>names</span><span class=p>[</span><span class=n>a</span><span class=p>],</span><span class=n>names</span><span class=p>[</span><span class=n>b</span><span class=p>])</span>
	<span class=n>names2</span><span class=p>[</span><span class=n>a</span><span class=p>]</span><span class=o>=</span><span class=n>names2</span><span class=p>[</span><span class=n>a</span><span class=p>]</span><span class=o>+</span><span class=n>names2</span><span class=p>[</span><span class=n>b</span><span class=p>]</span>
	<span class=n>names2</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>names2</span><span class=p>[</span><span class=n>b</span><span class=p>])</span>
	<span class=n>sublist</span> <span class=o>=</span> <span class=p>[</span><span class=n>names</span><span class=p>[</span><span class=n>a</span><span class=p>],</span> <span class=n>names</span><span class=p>[</span><span class=n>b</span><span class=p>]]</span>
	<span class=n>names</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>names</span><span class=p>[</span><span class=n>b</span><span class=p>])</span>
	<span class=n>names</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>names</span><span class=p>[</span><span class=n>a</span><span class=p>])</span>
	<span class=n>names</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>sublist</span><span class=p>)</span>
	<span class=n>column1</span> <span class=o>=</span> <span class=n>table</span><span class=p>[:,</span> <span class=n>a</span><span class=p>:</span><span class=n>a</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
	<span class=n>column2</span> <span class=o>=</span> <span class=n>table</span><span class=p>[:,</span> <span class=n>b</span><span class=p>:</span><span class=n>b</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
	<span class=c1># Combine the two columns</span>
	<span class=n>combine</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>column1</span><span class=p>,</span> <span class=n>column2</span><span class=p>))</span>
	<span class=c1># Get the mean of all the rows</span>
	<span class=n>combine</span> <span class=o>=</span> <span class=n>combine</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=n>combine</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span>
	<span class=c1># Delete the rows corresponding to the two species</span>
	<span class=n>combine</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=n>combine</span><span class=p>,</span> <span class=p>[</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>],</span> <span class=mi>0</span><span class=p>)</span>
	<span class=c1># Delete the rows/columns corresponding to the two species from the main table</span>
	<span class=n>table</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=n>table</span><span class=p>,</span> <span class=p>[</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>],</span> <span class=mi>0</span><span class=p>)</span>
	<span class=n>table</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=n>table</span><span class=p>,</span> <span class=p>[</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>],</span> <span class=mi>1</span><span class=p>)</span>
	<span class=c1># Append the amended column to the main table</span>
	<span class=n>combine</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>transpose</span><span class=p>(</span><span class=n>combine</span><span class=p>)</span>
	<span class=n>table</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>table</span><span class=p>,</span> <span class=nb>min</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>),</span> <span class=n>combine</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
	<span class=c1># Add a zero the the column and transpose it</span>
	<span class=n>combine</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>combine</span><span class=p>,</span> <span class=nb>min</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>),</span> <span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
	<span class=c1># Add this row to the bottom of the main table</span>
	<span class=n>table</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>table</span><span class=p>,</span> <span class=nb>min</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>),</span> <span class=n>combine</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
	<span class=c1># Return the table back to the main function</span>
	<span class=k>return</span> <span class=n>table</span>
</code></pre></div></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css integrity=sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X crossorigin=anonymous></div></body></html>