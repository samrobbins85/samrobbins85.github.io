<!doctype html><style>html{height:100vh}body{min-height:100vh;display:grid;grid-template-rows:1fr auto}.footer{grid-row-start:2;grid-row-end:3}</style><html lang=en-gb><head><meta charset=utf-8><title>Sam Robbins</title><link rel=canonical href=https://samrobbins.uk/portfolio/cv-theme/><meta name=viewport content="width=device-width,initial-scale=1"><meta name=monetization content="$ilp.uphold.com/reGxiLfZfUmn"><meta name=description property="og:description" content="A Hugo theme for CVs"><meta name=image property="og:image" content="/"><meta name=author content="Sam Robbins"><meta name=generator content="Hugo 0.75.1"><link rel=stylesheet href=/css/syntax.min.css integrity media=screen><script src=https://cdn.jsdelivr.net/npm/mailgo@0.9.14/dist/mailgo.min.js defer></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link href=/css/tailwind.min.css rel=stylesheet><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js integrity=sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js integrity=sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "8348650db5154c01999667d263b7e6e1"}'></script></head><body class=portfolio><div class=wrapper><nav class="fixed h-16 p-4 bg-white border-b border-gray-200 w-full z-20"><div class="flex divide-x-4 divide-transparent pr-6 text-lg items-center text-gray-700"><a href=/ class=font-normal>Home</a>
<a href=/about/ title=About>About</a>
<a href=/blog/ title=Blog>Blog</a>
<a class="text-gray-800 font-semibold" href=/portfolio/ title=Portfolio>Portfolio</a>
<a href=/writing/ title=Writing>Writing</a></div></nav><section class="pt-20 px-4"><div class="container mx-auto"><h1 class="text-4xl text-center font-semibold">CV Theme</h1><p class="text-center text-gray-600 text-xl">A Hugo theme for CVs</p><div class="py-4 text-gray-600"><p class=text-center><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="h-4 w-4 inline-block stroke-current text-gray-600"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5A2 2 0 003 7v12a2 2 0 002 2z"/></svg>Sep 19, 2020</p><p class=text-center><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="h-4 w-4 inline-block stroke-current text-gray-600"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3A9 9 0 113 12a9 9 0 0118 0z"/></svg>2 minutes</p></div><div class="flex justify-center gap-x-40 gap-y-4 flex-wrap"><div class="border border-gray-500 px-4 py-2 w-32"><a href=https://cv.samrobbins.uk/><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="h-6 w-6 inline-block stroke-current text-gray-600"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657.0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657.0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"/></svg>Website</a></div><div class="border border-gray-500 px-4 py-2 group relative w-32 text-center"><button type=button>
<img src=https://unpkg.com/simple-icons@v3/icons/github.svg class="inline-block h-6 w-6 mr-2"> GitHub</button><div class="absolute bg-white border border-gray-400 mt-2 p-4 w-64 hidden group-hover:block mx-auto left-0 right-0" style=left:50%;transform:translate(-50%,0%)><ul class="divide-y-4 divide-transparent text-left"><li><a style=color:#0366d6;font-weight:600 href=https://github.com/samrobbins85/public-cv><span><img class=inline-block loading=lazy src=https://res.cloudinary.com/samrobbins/image/upload/v1593092912/repo_ec3slk.svg></span> public-cv</a></li><li><a style=color:#0366d6;font-weight:600 href=https://github.com/samrobbins85/cv-theme><span><img class=inline-block loading=lazy src=https://res.cloudinary.com/samrobbins/image/upload/v1593092912/repo_ec3slk.svg></span> cv-theme</a></li></ul></div></div></div><hr class=my-4><h2 class="text-center text-3xl">Built with</h2><section class="py-6 px-2"><div class=container><div class="flex justify-center gap-x-10 flex-wrap gap-y-4"><div><a href=https://pptr.dev/><img class="h-20 w-32 object-contain" src=https://res.cloudinary.com/samrobbins/image/upload/v1600618396/puppeteer_klfg7k.svg alt=Puppeteer loading=lazy style=cursor:pointer></a></div><div><a href=https://gohugo.io/><img class="h-20 w-32 object-contain" src=https://res.cloudinary.com/samrobbins/image/upload/v1591793276/logos/logos_hugo_h2xbne.svg alt=Hugo loading=lazy style=cursor:pointer></a></div><div><a href=https://tailwindcss.com/><img class="h-20 w-32 object-contain" src=https://res.cloudinary.com/samrobbins/image/upload/v1597140224/tailwindcss_rnpshz.svg alt="Tailwind CSS" loading=lazy style=cursor:pointer></a></div></div></div></section><hr class=py-4></div></div></section><div class="container prose mx-auto w-screen px-4 pb-6"><p>For a long time my CV had been produced using LaTeX. This is one of the things LaTeX is designed for as typesetting is very important for a CV. However it had recently been causing frustration as the design wasn&rsquo;t nearly as customisable as the websites I was creating. Also inserting content was tricky as some markup also had to be included, making it more difficult than websites I was producing in Hugo where I could import data from a <code>.yml</code> file.</p><p>So I started on creating a new Hugo theme for my CV. Using Tailwind CSS and my knowledge from creating previous Hugo sites, this was relatively easy, and being able to use the Golang statements in order to loop the insertion of data was very useful in all the sections. This lead to all the normal sections looking more or less like this:</p><div class=highlight><pre class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>section</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;pt-2&#34;</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>h2</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;text-xl pb-1&#34;</span><span class=p>&gt;</span>Experience<span class=p>&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>hr</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;py-1&#34;</span> <span class=p>/&gt;</span>
  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;divide-y-4 divide-transparent&#34;</span><span class=p>&gt;</span>
    {{ range .Site.Data.cv.experience.item }}
    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;grid grid-cols-6 gap-x-4&#34;</span><span class=p>&gt;</span>
      <span class=p>&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;col-span-5&#34;</span>
        <span class=p>&gt;&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;font-semibold&#34;</span><span class=p>&gt;</span>{{ .position }}<span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>{{ if .description }}
        <span class=p>&lt;</span><span class=nt>br</span> <span class=p>/&gt;&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;text-gray-800&#34;</span><span class=p>&gt;</span>{{ .description }}<span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>{{ end
        }}<span class=p>&lt;/</span><span class=nt>span</span>
      <span class=p>&gt;</span>
      <span class=p>&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;col-span-1 text-gray-800 italic&#34;</span>
        <span class=p>&gt;&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;float-left&#34;</span><span class=p>&gt;</span>{{ .date }}<span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;&lt;/</span><span class=nt>span</span>
      <span class=p>&gt;</span>
    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
    {{ end }}
  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>section</span><span class=p>&gt;</span>
</code></pre></div><p>The difficulty then came in my other aim for this project, for it to automatically produce PDFs of the CV, as this is what most employers will require.</p><p>For this I decided to use Puppeteer, as it can produce a PDF from a HTML page. This required a fair amount of customisation from the sample code.</p><p>The first problem is that my hosting provider, Vercel, runs as root, and so puppeteer couldn&rsquo;t be run in it&rsquo;s normal fashion, and instead needed running without the sandbox. This was done in the following way:</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=kr>const</span> <span class=nx>browser</span> <span class=o>=</span> <span class=nx>await</span> <span class=nx>puppeteer</span><span class=p>.</span><span class=nx>launch</span><span class=p>({</span> <span class=nx>args</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;--no-sandbox&#34;</span><span class=p>]</span> <span class=p>});</span>
</code></pre></div><p>Then came the problem of providing the file to puppeteer, the problem here is that puppeteer is mostly designed to run on a live server, taking a URL. But this would not be possible during the build step, so <code>path</code> needed to be used in order to find the correct file. Also puppeteer in it&rsquo;s default state won&rsquo;t wait for external resources to be fetched, and for my CV I use a custom font. Luckily, puppeteer has a <code>waitUntil</code> key that allows you to tell it to wait for resources to be fetched</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=nx>await</span> <span class=nx>page</span><span class=p>.</span><span class=kr>goto</span><span class=p>(</span><span class=sb>`file:</span><span class=si>${</span><span class=nx>path</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=nx>__dirname</span><span class=p>,</span> <span class=s2>&#34;public/index.html&#34;</span><span class=p>)</span><span class=si>}</span><span class=sb>`</span><span class=p>,</span> <span class=p>{</span>
  <span class=nx>waitUntil</span><span class=o>:</span> <span class=s2>&#34;networkidle2&#34;</span><span class=p>,</span>
<span class=p>});</span>
</code></pre></div><p>Next up was inserting a button on the webpage to take you to the PDF. This is simple, however I didn&rsquo;t want that button to appear in the PDF. Puppeteer alllows you to manipulate the nodes of the webpage using <code>page.evaluate</code> so I used this, along with an ID set on the outermost div of the button, to remove the button from the PDF</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=nx>await</span> <span class=nx>page</span><span class=p>.</span><span class=nx>evaluate</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
  <span class=kd>let</span> <span class=nx>example</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s2>&#34;#pdf_link&#34;</span><span class=p>);</span>
  <span class=nx>example</span><span class=p>.</span><span class=nx>parentNode</span><span class=p>.</span><span class=nx>removeChild</span><span class=p>(</span><span class=nx>example</span><span class=p>);</span>
<span class=p>});</span>
</code></pre></div><p>Finally was producing the PDF, I wanted this to be inserted into <code>/public</code> so that it could easily be accessed, and wanted it of A4 size, which is a standard requirement for CVs.</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=nx>await</span> <span class=nx>page</span><span class=p>.</span><span class=nx>pdf</span><span class=p>({</span> <span class=nx>path</span><span class=o>:</span> <span class=s2>&#34;public/cv.pdf&#34;</span><span class=p>,</span> <span class=nx>format</span><span class=o>:</span> <span class=s2>&#34;A4&#34;</span><span class=p>,</span> <span class=nx>scale</span><span class=o>:</span> <span class=mf>0.8</span> <span class=p>});</span>
</code></pre></div><p>The build command was then tweaked to run the file containing the puppeteer code after building the website with the following build command</p><div class=highlight><pre class=chroma><code class=language-json data-lang=json><span class=s2>&#34;scripts&#34;</span><span class=err>:</span> <span class=p>{</span>
    <span class=nt>&#34;build&#34;</span><span class=p>:</span> <span class=s2>&#34;hugo &amp;&amp; node index.js&#34;</span><span class=p>,</span>
    <span class=nt>&#34;dev&#34;</span><span class=p>:</span> <span class=s2>&#34;hugo server&#34;</span>
  <span class=p>}</span><span class=err>,</span>
</code></pre></div></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css integrity=sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X crossorigin=anonymous></div></body></html>