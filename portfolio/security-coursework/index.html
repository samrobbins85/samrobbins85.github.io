<!doctype html><style>html{height:100vh}body{min-height:100vh;display:grid;grid-template-rows:1fr auto}.footer{grid-row-start:2;grid-row-end:3}</style><html lang=en-gb><head><meta charset=utf-8><title>Sam Robbins</title><link rel=canonical href=https://samrobbins.uk/portfolio/security-coursework/><meta name=viewport content="width=device-width,initial-scale=1"><meta name=monetization content="$ilp.uphold.com/reGxiLfZfUmn"><meta name=description property="og:description" content="Performing a Pentest and CTF on a Virtual Machine"><meta name=image property="og:image" content="/"><meta name=author content="Sam Robbins"><meta name=generator content="Hugo 0.75.1"><link rel=stylesheet href=/css/syntax.min.css integrity media=screen><script src=https://cdn.jsdelivr.net/npm/mailgo@0.9.14/dist/mailgo.min.js defer></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link href=/css/tailwind.min.css rel=stylesheet><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js integrity=sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js integrity=sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "8348650db5154c01999667d263b7e6e1"}'></script></head><body class=portfolio><div class=wrapper><nav class="fixed h-16 p-4 bg-white border-b border-gray-200 w-full z-20"><div class="flex divide-x-4 divide-transparent pr-6 text-lg items-center text-gray-700"><a href=/ class=font-normal>Home</a>
<a href=/about/ title=About>About</a>
<a href=/blog/ title=Blog>Blog</a>
<a class="text-gray-800 font-semibold" href=/portfolio/ title=Portfolio>Portfolio</a>
<a href=/writing/ title=Writing>Writing</a></div></nav><section class="pt-20 px-4"><div class="container mx-auto"><h1 class="text-4xl text-center font-semibold">Security Coursework</h1><p class="text-center text-gray-600 text-xl">Performing a Pentest and CTF on a Virtual Machine</p><div class="py-4 text-gray-600"><p class=text-center><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="h-4 w-4 inline-block stroke-current text-gray-600"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5A2 2 0 003 7v12a2 2 0 002 2z"/></svg>Dec 06, 2019</p><p class=text-center><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="h-4 w-4 inline-block stroke-current text-gray-600"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3A9 9 0 113 12a9 9 0 0118 0z"/></svg>3 minutes</p></div><div class="flex justify-center gap-x-40 gap-y-4 flex-wrap"><div class="border border-gray-500 px-4 py-2 w-32"><a href=https://github.com/samrobbins85/NS-Security-Coursework><img src=https://unpkg.com/simple-icons@v3/icons/github.svg class="inline-block h-6 w-6 mr-2"> Github</a></div></div><hr class=my-4><h2 class="text-center text-3xl">Built with</h2><section class="py-6 px-2"><div class=container><div class="flex justify-center gap-x-10 flex-wrap gap-y-4"><div><a href=https://www.kali.org/><img class="h-20 w-32 object-contain" src=https://res.cloudinary.com/samrobbins/image/upload/q_auto/v1599475099/Kali_Linux_2.0_wordmark_wsz9aw.svg alt="Kali Linux" loading=lazy style=cursor:pointer></a></div><div><a href=https://nmap.org/><img class="h-20 w-32 object-contain" src=https://res.cloudinary.com/samrobbins/image/upload/q_auto/v1599475328/nmap-logo-64px_sdhhyu.svg alt=nmap loading=lazy style=cursor:pointer></a></div><div><a href=https://www.openwall.com/john/><img class="h-20 w-32 object-contain" src=https://res.cloudinary.com/samrobbins/image/upload/q_auto/v1599475230/logo_john_the_ripper_newolr.png alt="John the Ripper" loading=lazy style=cursor:pointer></a></div><div><a href=https://www.gnu.org/software/grub/><img class="h-20 w-32 object-contain" src=https://res.cloudinary.com/samrobbins/image/upload/q_auto/v1599475460/Grub_logo_large_s4qmeb.png alt=GRUB loading=lazy style=cursor:pointer></a></div></div></div></section><hr class=py-4></div></div></section><div class="container prose mx-auto w-screen px-4 pb-6"><p>For this coursework we were to find vulnerabilities in a system and explain how they could be mitigated, along with solving a murder mystery in the system, which required finding and decoding a range of files.</p><h1 id=vulnerabilities>Vulnerabilities</h1><h2 id=database-file-can-be-opened-by-any-user>Database file can be opened by any user</h2><p>There was a file in the database folder named <code>Database.db</code>, this could be opened using <code>sqlite</code> and with the command <code>SELECT * FROM Users</code>, you could find personal information on the users, such as passwords.</p><p>This could simply be mitigated by not providing the file to users. Further mitigation though would be to hash passwords and redact credit card information.</p><h2 id=program-vulnerable-to-buffer-overflow>Program vulnerable to buffer overflow</h2><p>There was a program that could be used to get details about a Bitcoin wallet. However the password input for this was vulnerable to buffer overflow by inserting a password of 64 characters, followed by <code>\0x01</code>, this overwrites a the variable to decide if the password is correct from 0 to 1, allowing you to see the private key.</p><p>This could be mitigated using <code>fgets</code> rather than <code>gets</code> as <code>fgets</code> allows you to limit the number of characters you take in, for example to 64.</p><h2 id=the-compiled-executable-contains-both-the-password-and-private-key>The compiled executable contains both the password and private key</h2><p>For the program described above, simply reading it in terminal exposes both the password and private key. The password should be stored as a hash, and the inputted password then hashed and compared to it. The private key should also be encrypted, using the password as the key to decrypt it.</p><h2 id=the-standard-user-can-access-any-users-directory>The standard user can access any user&rsquo;s directory</h2><p>By simply moving up the filesystem with <code>cd</code>, a user can then move into any of the other accounts. This could be mitigated with file permissions by creating a group for each user, and setting that user group to only own the files within their directory. This could be done using <code>chmod</code></p><h2 id=the-system-passwords-for-other-users-can-be-found>The system passwords for other users can be found</h2><p>Running <code>cat /etc/passwd > passwords.txt</code> allows you to save the <code>passwd</code> file for cracking. This can then be transferred to another computer with forensic tools and John the Ripper can be used to get the passwords of all the users. This could be mitigated with <code>pwconv</code> to use a shadow file instead of <code>/etc/passwd</code>. Also using more secure passwords and hashing algorithms would make it more difficult to reverse the hashes.</p><h2 id=port-8888-has-a-root-shell>Port 8888 has a root shell</h2><p>By running <code>nmap</code>, it is revealed that port 8888 is open. Getting access to this using <code>netcat</code> gives you a shell which it is revealed is a root shell.</p><p>This is mitigated by removing a script to open up this shell, which is located at <code>/etc/init.d/jess.sh</code>. Using a firewall to ensure no unspecified ports are open would also prevent this happening in the future.</p><h2 id=you-can-access-all-files-on-the-system-from-the-website>You can access all files on the system from the website</h2><p>Using the string <code>%2e%2e%2f</code> at the end of the URL you can go up a level in the system, this can be used repeated to move around the filesystem, allowing for use of other exploits detailed here, such as one on <code>/etc/passwd</code></p><p>This can be mitigated by using regular expressions to prevent the typing of this or similar strings. The webserver could also be set up inside a chroot jail so that the website views its own directory as the root directory of the computer and can&rsquo;t move outside that.</p><h2 id=you-can-log-in-as-any-user-on-the-website>You can log in as any user on the website</h2><p>On the login page providing the username <code>' OR 1==1 --</code> and clicking login allows you to log in as root. Prepared statements should be used here to insert the login information so the username and password can&rsquo;t be run as code.</p><h2 id=you-can-get-a-root-shell-from-grub>You can get a root shell from GRUB</h2><p>By editing the boot command to run <code>init=/bin/sh</code>, you will get a root shell. A password should be added to GRUB to mitigate this.</p><h2 id=the-database-program-can-be-used-to-run-commands-as-root>The database program can be used to run commands as root</h2><p>The database program runs the input command you give it, so by running the command <code>./Backup "; $SHELL # "</code> it will replace the current command with a command to open the shell as root.</p><p>Using the file operations in C would be much better suited here rather than running a system command</p></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css integrity=sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X crossorigin=anonymous></div></body></html>