<!doctype html><style>html{height:100vh}body{min-height:100vh;display:grid;grid-template-rows:1fr auto}.footer{grid-row-start:2;grid-row-end:3}</style><html lang=en-gb><head><meta charset=utf-8><title>Sam Robbins</title><link rel=canonical href=https://samrobbins.uk/portfolio/oxford-digithon/><meta name=viewport content="width=device-width,initial-scale=1"><meta name=monetization content="$ilp.uphold.com/reGxiLfZfUmn"><meta name=description property="og:description" content="A Firefox Browser Extension"><meta name=image property="og:image" content="/"><meta name=author content="Sam Robbins"><meta name=generator content="Hugo 0.75.1"><link rel=stylesheet href=/css/syntax.min.css integrity media=screen><script src=https://cdn.jsdelivr.net/npm/mailgo@0.9.14/dist/mailgo.min.js defer></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link href=/css/tailwind.min.css rel=stylesheet><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js integrity=sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js integrity=sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "8348650db5154c01999667d263b7e6e1"}'></script></head><body class=portfolio><div class=wrapper><nav class="fixed h-16 p-4 bg-white border-b border-gray-200 w-full z-20"><div class="flex divide-x-4 divide-transparent pr-6 text-lg items-center text-gray-700"><a href=/ class=font-normal>Home</a>
<a href=/about/ title=About>About</a>
<a href=/blog/ title=Blog>Blog</a>
<a class="text-gray-800 font-semibold" href=/portfolio/ title=Portfolio>Portfolio</a>
<a href=/writing/ title=Writing>Writing</a></div></nav><section class="pt-20 px-4"><div class="container mx-auto"><h1 class="text-4xl text-center font-semibold">Oxford Digithon</h1><p class="text-center text-gray-600 text-xl">A Firefox Browser Extension</p><div class="py-4 text-gray-600"><p class=text-center><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="h-4 w-4 inline-block stroke-current text-gray-600"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5A2 2 0 003 7v12a2 2 0 002 2z"/></svg>May 30, 2020</p><p class=text-center><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="h-4 w-4 inline-block stroke-current text-gray-600"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3A9 9 0 113 12a9 9 0 0118 0z"/></svg>3 minutes</p></div><div class="flex justify-center gap-x-40 gap-y-4 flex-wrap"><div class="border border-gray-500 px-4 py-2 group relative w-48 text-center"><button type=button><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="h-6 w-6 inline-block stroke-current text-teal-600"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7A4 4 0 115 7a4 4 0 018 0z"/></svg> Team
Project</button><div class="absolute bg-white border border-gray-400 mt-2 p-4 w-64 hidden group-hover:block mx-auto left-0 right-0" style=left:50%;transform:translate(-50%,0%)><ul class="divide-y-4 divide-transparent text-left"><li><a href=https://github.com/samrobbins85><img src=https://github.com/samrobbins85.png alt="GitHub Avatar" width=42 height=42 style=border-radius:50% class=inline-block> <span class=text-gray-700>samrobbins85</span></a></li><li><a href=https://github.com/karina-talibzhanova><img src=https://github.com/karina-talibzhanova.png alt="GitHub Avatar" width=42 height=42 style=border-radius:50% class=inline-block> <span class=text-gray-700>karina-talibzhanova</span></a></li></ul></div></div><div class="border border-gray-500 px-4 py-2 w-32"><a href=https://github.com/karina-talibzhanova/oxfordhack2020><img src=https://unpkg.com/simple-icons@v3/icons/github.svg class="inline-block h-6 w-6 mr-2"> Github</a></div></div><hr class=my-4><h2 class="text-center text-3xl">Built with</h2><section class="py-6 px-2"><div class=container><div class="flex justify-center gap-x-10 flex-wrap gap-y-4"><div><a href=https://www.ecma-international.org/memento/tc39.htm><img class="h-20 w-32 object-contain" src=https://res.cloudinary.com/samrobbins/image/upload/q_auto/v1591793272/logos/logos_javascript_adj1dx.svg alt=JavaScript loading=lazy style=cursor:pointer></a></div><div><a href=https://www.mozilla.org/en-GB/firefox/><img class="h-20 w-32 object-contain" src=https://res.cloudinary.com/samrobbins/image/upload/q_auto/v1593368547/firefox-ar21_cps6me.svg alt="Firefox WebExtensions" loading=lazy style=cursor:pointer></a></div></div></div></section><hr class=py-4></div></div></section><div class="container prose mx-auto w-screen px-4 pb-6"><p>For this project we created a web browser extension designed to make you less productive. It did this by making productive websites difficult to use and directing you away from them. You can see our demonstration video here:</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/b_KQsr_vBSI style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p>This was created using the WebExtensions API so should be compatible with browsers other than Mozilla Firefox, but all our testing was done on that.</p><h2 id=installation>Installation</h2><p>To install, first download the project from the GitHub linked at the top of the page</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>git clone https://github.com/karina-talibzhanova/oxfordhack2020.git
</code></pre></div><p>Then navigate to the url <code>about:debugging#/runtime/this-firefox</code>, this gives you the option to load a temporary addon. By selecting any file in the root level of the directory downloaded, the extension will be installed.</p><h2 id=features>Features</h2><h3 id=page-detection>Page detection</h3><p>This extension will detect if you are on a productive page to move you away from it. In order to detect these changes, the following two functions are used</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=nx>async</span> <span class=kd>function</span> <span class=nx>handleActivated</span><span class=p>(</span><span class=nx>info</span><span class=p>)</span> <span class=p>{</span>
  <span class=k>try</span> <span class=p>{</span>
    <span class=kd>let</span> <span class=nx>tabInfo</span> <span class=o>=</span> <span class=nx>await</span> <span class=nx>browser</span><span class=p>.</span><span class=nx>tabs</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>info</span><span class=p>.</span><span class=nx>tabId</span><span class=p>);</span>
    <span class=nx>action_url</span><span class=p>(</span><span class=nx>tabInfo</span><span class=p>.</span><span class=nx>url</span><span class=p>,</span> <span class=nx>info</span><span class=p>.</span><span class=nx>tabId</span><span class=p>);</span>
  <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=nx>error</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>

<span class=kd>function</span> <span class=nx>handleUpdated</span><span class=p>(</span><span class=nx>tabId</span><span class=p>,</span> <span class=nx>changeInfo</span><span class=p>,</span> <span class=nx>tabInfo</span><span class=p>)</span> <span class=p>{</span>
  <span class=k>if</span> <span class=p>(</span><span class=nx>changeInfo</span><span class=p>.</span><span class=nx>url</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>action_url</span><span class=p>(</span><span class=nx>changeInfo</span><span class=p>.</span><span class=nx>url</span><span class=p>,</span> <span class=nx>tabID</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>

<span class=nx>browser</span><span class=p>.</span><span class=nx>tabs</span><span class=p>.</span><span class=nx>onUpdated</span><span class=p>.</span><span class=nx>addListener</span><span class=p>(</span><span class=nx>handleUpdated</span><span class=p>);</span>
<span class=nx>browser</span><span class=p>.</span><span class=nx>tabs</span><span class=p>.</span><span class=nx>onActivated</span><span class=p>.</span><span class=nx>addListener</span><span class=p>(</span><span class=nx>handleActivated</span><span class=p>);</span>
</code></pre></div><p>Due to the different nature of the result of a created tab compared to switching to a tab, two different functions were needed, but they then feed into the same function.</p><h3 id=timer>Timer</h3><p>There is a timer visible in the icon of the extension which will count down when you are on productive websites, and when you are at the end of the timer, it will redirect you to a distracting page. This was created using the following function for redirection:</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=kd>function</span> <span class=nx>close_tab</span><span class=p>(</span><span class=nx>tabID</span><span class=p>)</span> <span class=p>{</span>
  <span class=nx>browser</span><span class=p>.</span><span class=nx>tabs</span><span class=p>.</span><span class=nx>create</span><span class=p>({</span> <span class=nx>url</span><span class=o>:</span> <span class=s2>&#34;https://www.facebook.com&#34;</span> <span class=p>});</span>
  <span class=nx>browser</span><span class=p>.</span><span class=nx>tabs</span><span class=p>.</span><span class=nx>remove</span><span class=p>(</span><span class=nx>tabID</span><span class=p>);</span>
  <span class=nx>browser</span><span class=p>.</span><span class=nx>browserAction</span><span class=p>.</span><span class=nx>setBadgeBackgroundColor</span><span class=p>({</span> <span class=nx>color</span><span class=o>:</span> <span class=s2>&#34;green&#34;</span> <span class=p>});</span>
  <span class=nx>browser</span><span class=p>.</span><span class=nx>browserAction</span><span class=p>.</span><span class=nx>setBadgeText</span><span class=p>({</span> <span class=nx>text</span><span class=o>:</span> <span class=s2>&#34;âœ“&#34;</span> <span class=p>});</span>
<span class=p>}</span>
</code></pre></div><p>And this function for the timer:</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=kd>function</span> <span class=nx>time_notification</span><span class=p>(</span><span class=nx>url</span><span class=p>,</span> <span class=nx>tabID</span><span class=p>)</span> <span class=p>{</span>
  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Creating a timer!&#34;</span><span class=p>);</span>
  <span class=kd>var</span> <span class=nx>seconds</span> <span class=o>=</span> <span class=mi>60</span><span class=p>;</span>
  <span class=nx>browser</span><span class=p>.</span><span class=nx>notifications</span><span class=p>.</span><span class=nx>create</span><span class=p>(</span><span class=s2>&#34;reee&#34;</span><span class=p>,</span> <span class=p>{</span>
    <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;basic&#34;</span><span class=p>,</span>
    <span class=nx>title</span><span class=o>:</span> <span class=s2>&#34;Timer&#34;</span><span class=p>,</span>
    <span class=nx>message</span><span class=o>:</span>
      <span class=s2>&#34;You have &#34;</span> <span class=o>+</span>
      <span class=nb>String</span><span class=p>(</span><span class=nx>seconds</span><span class=p>)</span> <span class=o>+</span>
      <span class=s2>&#34; seconds to get back to procrastinating.&#34;</span><span class=p>,</span>
  <span class=p>});</span>
  <span class=k>if</span> <span class=p>(</span><span class=k>typeof</span> <span class=nx>countdown</span> <span class=o>!=</span> <span class=s2>&#34;undefined&#34;</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>clearInterval</span><span class=p>(</span><span class=nx>countdown</span><span class=p>);</span>
    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Removing a timer&#34;</span><span class=p>);</span>
  <span class=p>}</span>

  <span class=nx>countdown</span> <span class=o>=</span> <span class=nx>setInterval</span><span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
    <span class=k>if</span> <span class=p>(</span><span class=nx>seconds</span> <span class=o>&lt;=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
      <span class=nx>clearInterval</span><span class=p>(</span><span class=nx>countdown</span><span class=p>);</span>
      <span class=nx>close_tab</span><span class=p>(</span><span class=nx>tabID</span><span class=p>);</span>
      <span class=c1>// mess around with the user here
</span><span class=c1></span>    <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=nx>good</span><span class=p>.</span><span class=nx>includes</span><span class=p>(</span><span class=nx>url</span><span class=p>))</span> <span class=p>{</span>
      <span class=nx>clearInterval</span><span class=p>(</span><span class=nx>countdown</span><span class=p>);</span>
    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
      <span class=nx>seconds</span> <span class=o>-=</span> <span class=mi>1</span><span class=p>;</span>
      <span class=nx>browser</span><span class=p>.</span><span class=nx>browserAction</span><span class=p>.</span><span class=nx>setBadgeText</span><span class=p>({</span> <span class=nx>text</span><span class=o>:</span> <span class=nb>String</span><span class=p>(</span><span class=nx>seconds</span><span class=p>)</span> <span class=p>});</span>
    <span class=p>}</span>
  <span class=p>},</span> <span class=mi>1000</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div><h3 id=changing-the-background-colours-of-all-the-divs>Changing the background colours of all the divs</h3><p>Due to the more aggressive nature of this intervention, it needed to be implemented as a content script, which we named <code>page-eater.js</code>. This file is then referenced in the <code>manifest.json</code> in the following way:</p><div class=highlight><pre class=chroma><code class=language-json data-lang=json><span class=p>{</span>
  <span class=nt>&#34;content_scripts&#34;</span><span class=p>:</span> <span class=p>[</span>
    <span class=p>{</span>
      <span class=nt>&#34;matches&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;*://*/*&#34;</span><span class=p>],</span>
      <span class=nt>&#34;js&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;page-eater.js&#34;</span><span class=p>]</span>
    <span class=p>}</span>
  <span class=p>]</span>
<span class=p>}</span>
</code></pre></div><p>The <code>"matches"</code> parameter takes a regular expression of which pages to run on, in our case, most pages, the <code>"js"</code> parameter then takes the file name of the content script.</p><p>In order to make the internet somewhat usable, we limited the scope of this intervention to wikipedia and ran the following code</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=k>if</span> <span class=p>(</span><span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>href</span><span class=p>.</span><span class=nx>startsWith</span><span class=p>(</span><span class=s2>&#34;https://en.wikipedia.org&#34;</span><span class=p>))</span> <span class=p>{</span>
  <span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>j</span> <span class=o>&lt;</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementsByTagName</span><span class=p>(</span><span class=s2>&#34;*&#34;</span><span class=p>).</span><span class=nx>length</span><span class=p>;</span> <span class=nx>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
    <span class=kd>var</span> <span class=nx>elem</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementsByTagName</span><span class=p>(</span><span class=s2>&#34;*&#34;</span><span class=p>)[</span><span class=nx>j</span><span class=p>];</span>
    <span class=nx>elem</span><span class=p>.</span><span class=nx>style</span><span class=p>[</span><span class=s2>&#34;background-color&#34;</span><span class=p>]</span> <span class=o>=</span>
      <span class=s2>&#34;rgb(&#34;</span> <span class=o>+</span>
      <span class=nb>String</span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span> <span class=o>*</span> <span class=mi>255</span><span class=p>))</span> <span class=o>+</span>
      <span class=s2>&#34;,&#34;</span> <span class=o>+</span>
      <span class=nb>String</span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span> <span class=o>*</span> <span class=mi>255</span><span class=p>))</span> <span class=o>+</span>
      <span class=s2>&#34;,&#34;</span> <span class=o>+</span>
      <span class=nb>String</span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span> <span class=o>*</span> <span class=mi>255</span><span class=p>))</span> <span class=o>+</span>
      <span class=s2>&#34;)&#34;</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><h3 id=removing-divs>Removing divs</h3><p>Another content script based intervention is to progressively remove all the divs from the page until it is unusable. Again, this is an aggressive method, so we limited the scope to stack overflow.</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=k>if</span> <span class=p>(</span><span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>href</span><span class=p>.</span><span class=nx>startsWith</span><span class=p>(</span><span class=s2>&#34;https://stackoverflow.com&#34;</span><span class=p>))</span> <span class=p>{</span>
  <span class=kd>var</span> <span class=nx>index_count</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementsByClassName</span><span class=p>(</span><span class=s2>&#34;question-summary&#34;</span><span class=p>).</span><span class=nx>length</span><span class=p>;</span>
  <span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
  <span class=kd>var</span> <span class=nx>delete_elems</span> <span class=o>=</span> <span class=nx>setInterval</span><span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
    <span class=k>if</span> <span class=p>(</span><span class=nx>i</span> <span class=o>&gt;=</span> <span class=nx>index_count</span><span class=p>)</span> <span class=p>{</span>
      <span class=nx>clearInterval</span><span class=p>(</span><span class=nx>delete_elems</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=kd>var</span> <span class=nx>elem</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementsByClassName</span><span class=p>(</span><span class=s2>&#34;question-summary&#34;</span><span class=p>)[</span><span class=nx>i</span><span class=p>];</span>
    <span class=nx>elem</span><span class=p>.</span><span class=nx>style</span><span class=p>[</span><span class=s2>&#34;opacity&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=nx>i</span> <span class=o>+=</span> <span class=mi>1</span><span class=p>;</span>
  <span class=p>},</span> <span class=mi>1000</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css integrity=sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X crossorigin=anonymous></div></body></html>